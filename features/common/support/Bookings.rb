#!/bin/env ruby
# encoding: utf-8

def check_de_api
  username=DE_USER[:valid][:username]
  password=DE_USER[:valid][:password]

  cmd=%Q{curl 'http://37.46.24.155:3001/login' -H 'tui-public-key: d7ce7733-c994-4c57-896c-5fe647c254bc' -H 'Origin:http://37.46.24.155:8001' -H 'tui-brand: tui-de' -H 'Accept-Language: en-US,en;q=0.8'  -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryKYBLZNr2CcAzqU5v' -H 'Accept: */*' -H 'Referer: http://37.46.24.155:8001/index.html' -H 'Accept-Encoding: gzip,deflate,sdch' -H 'Connection: keep-alive' -H 'tui-handshake: c182d5dea3e695394cc04df2816cfe1cd725fd7e' --data-binary $'------WebKitFormBoundaryKYBLZNr2CcAzqU5v\r\nContent-Disposition: form-data; name="username"\r\n\r\n#{username}\r\n------WebKitFormBoundaryKYBLZNr2CcAzqU5v\r\nContent-Disposition: form-data; name="password"\r\n\r\n#{password}\r\n------WebKitFormBoundaryKYBLZNr2CcAzqU5v--\r\n' --compressed}
  res=JSON.parse `#{cmd}`
  auth=res["payload"]["auth"].match(/PHPSESSID=(.*?);/)
  puts "DE MEINE CURL SUCCESSFUL: DETAILS FETCHED FROM SERVER"
end

if $g_current_app== "DE_MT"
  check_de_api

  USER_INFO||={"payload"=>{"userName"=>{"firstName"=>"Peter", "lastName"=>"Pan"}, "reservationLists"=>{"CURRENT"=>[{"startDate"=>"2014-08-12", "destination"=>"V.A.E. Dubai, Dubai", "mainProductType"=>"Unterkunft", "allProductTypes"=>["Flug", "Versicherung", "Unterkunft", "Unterkunft", "Transfer", "Transfer", "Flug"], "id"=>"75511486"}, {"startDate"=>"2014-09-06", "destination"=>"Palma de Mallorca", "mainProductType"=>"Flug", "allProductTypes"=>["Flug"], "id"=>"75511407"}, {"startDate"=>"2014-09-15", "destination"=>"Thailand", "mainProductType"=>"Transfer", "allProductTypes"=>["Transfer"], "id"=>"80522737"}], "PAST"=>[{"startDate"=>"2013-10-14", "destination"=>"Kreta, Bali", "mainProductType"=>"Unterkunft", "allProductTypes"=>["Flug", "Versicherung", "Unterkunft", "Flug"], "id"=>"75405535"}]}, "selectedReservation"=>"75511486", "agency"=>{"title"=>"Hier habe ich meinen Urlaub gebucht", "imageUrl"=>"https://test.meine-tui.de/img/app/agency_default.jpg", "subTitle"=>"Prozessorganisation und Vertrieb", "text"=>"Non Direktinkasso\n\nKarl-Wiechert-Allee 23\nD 30625 Hannover", "phone"=>"+49 511 5674337", "email"=>"silke.pirr@tui.de", "homepageUrl"=>nil, "logo"=>nil}, "countdownStartDateAsUnixTime"=>1407875700, "ttl"=>21600}, "name"=>"HomeView"}

  booking_id=75511486
  #Payload from home
  TYPICAL_BOOKING||={"payload"=>{"destination"=>"V.A.E. Dubai, Dubai", "userName"=>"Peter Pan", "reservationCode"=>"75511486", "brand"=>"ati", "countdown"=>{"startDateTimeAsUnixTime"=>1407875700, "endDateTimeAsUnixTime"=>1408917600, "status"=>"countdown"}, "weather"=>{"numberOfLocations"=>2, "data"=>[{"name"=>"Dubai", "type"=>0, "temperature"=>36, "temperatureFor"=>"air"}, {"name"=>"Curepipe", "type"=>0, "temperature"=>27, "temperatureFor"=>"air"}]}, "bookingSummary"=>{"brand"=>"ati", "overview"=>{"infoList"=>[{"key"=>"bookingCode", "value"=>"75511486", "title"=>"Vorgang/Buchungsnummer", "type"=>"string", "order"=>1}, {"key"=>"countdownStartDateAsUnixTime", "value"=>1407875700, "title"=>"Countdown", "type"=>"integer", "order"=>2}, {"key"=>"leadPassenger", "value"=>"Paul Pan", "title"=>"Gebucht für", "type"=>"string", "order"=>3}, {"key"=>"otherPassengers", "value"=>["Suse Pan"], "title"=>"Weitere Reisende", "type"=>"array", "order"=>4}]}, "productDetails"=>[{"flightTimesSubjectToChange"=>true, "departureDateTime"=>"2014-08-12T22:35:00", "departureAirportName"=>"München", "departureAirportCode"=>"MUC", "arrivalDateTime"=>"2014-08-14T09:35:00", "arrivalAirportName"=>"Mauritius", "arrivalAirportCode"=>"MRU", "carrierName"=>"Emirates", "cabinClassName"=>"Economy Class", "passengers"=>[{"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Paul Pan"}, {"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Suse Pan"}], "sectors"=>[{"departureDateTime"=>"2014-08-12T22:35:00", "departureAirportName"=>"München", "departureAirportCode"=>"MUC", "arrivalDateTime"=>"2014-08-13T06:30:00", "arrivalAirportName"=>"Dubai", "arrivalAirportCode"=>"DXB", "carrierName"=>"Emirates", "carrierCode"=>"EK", "flightNumber"=>"EK52", "cabinClassName"=>"Economy Class", "passengers"=>[{"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>"1ST", "arrivalAirportRailClass"=>nil, "fullName"=>"Paul Pan"}, {"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>"1ST", "arrivalAirportRailClass"=>nil, "fullName"=>"Suse Pan"}], "productType"=>nil, "serviceId"=>nil, "bookingCode"=>nil}, {"departureDateTime"=>"2014-08-14T03:05:00", "departureAirportName"=>"Dubai", "departureAirportCode"=>"DXB", "arrivalDateTime"=>"2014-08-14T09:35:00", "arrivalAirportName"=>"Mauritius", "arrivalAirportCode"=>"MRU", "carrierName"=>"Emirates", "carrierCode"=>"EK", "flightNumber"=>"EK701", "cabinClassName"=>"Economy Class", "passengers"=>[{"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Paul Pan"}, {"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Suse Pan"}], "productType"=>nil, "serviceId"=>nil, "bookingCode"=>nil}], "productType"=>"flight", "serviceId"=>"4240", "bookingCode"=>nil}, {"productType"=>"insurance", "serviceId"=>"1241", "name"=>"(RRV) Reiserücktritt-Plus ohne SB - pro Person", "supplierName"=>"Lloyds Versicherer London", "startDate"=>"2014-08-12", "endDate"=>"2014-08-25", "numberOfPax"=>2, "emergencyNumber"=>nil, "productTitle"=>"(RRV) Reiserücktritt-Plus ohne SB - pro Person", "shortDescription"=>nil, "longDescription"=>nil, "bookingCode"=>"L0/RRV"}, {"name"=>"Atlantis, The Palm", "destination"=>"V.A.E. Dubai", "countryName"=>"Vereinigte Arabische Emirate", "startDate"=>"2014-08-13", "endDate"=>"2014-08-14", "starRatingCodeName"=>"*****", "transferTypeName"=>"Transfer inkl.", "rooms"=>[{"name"=>"Doppelzimmer Meerblick Typ1", "boardName"=>"mit Frühstück", "passengers"=>[{"fullName"=>"Paul Pan"}, {"fullName"=>"Suse Pan"}]}], "geoCoords"=>{"latitude"=>25.130529072612, "longitude"=>55.117191508737, "zoomLevel"=>10}, "productType"=>"hotel", "serviceId"=>"3512", "bookingCode"=>"DXB10005"}, {"name"=>"Beachcomber Hotel Trou aux Biches Resort & Spa", "destination"=>"Mauritius", "countryName"=>"Mauritius", "startDate"=>"2014-08-14", "endDate"=>"2014-08-24", "starRatingCodeName"=>"*****+", "transferTypeName"=>"Transfer inkl.", "rooms"=>[{"name"=>"Suite Typ1", "boardName"=>"mit Frühstück", "passengers"=>[{"fullName"=>"Paul Pan"}, {"fullName"=>"Suse Pan"}]}], "geoCoords"=>nil, "productType"=>"hotel", "serviceId"=>"3513", "bookingCode"=>"MRU20015"}, {"name"=>"Flughafen Mauritius - Hotels Mauritius (Minibus, 1-6 Pers.)", "startDateTime"=>"2014-08-14T00:00:00", "endDateTime"=>"2014-08-14T00:00:00", "numberOfAdults"=>2, "numberOfChildren"=>0, "numberOfInfants"=>0, "numberOfPax"=>2, "productType"=>"transfer", "serviceId"=>"273", "bookingCode"=>"MRUXMG01"}, {"name"=>"Dubai Hotels - Dubai Airport (4-8 Pers)", "startDateTime"=>"2014-08-14T00:00:00", "endDateTime"=>"2014-08-14T00:00:00", "numberOfAdults"=>2, "numberOfChildren"=>0, "numberOfInfants"=>0, "numberOfPax"=>2, "productType"=>"transfer", "serviceId"=>"272", "bookingCode"=>"DXBXMC04"}, {"flightTimesSubjectToChange"=>true, "departureDateTime"=>"2014-08-24T22:15:00", "departureAirportName"=>"Mauritius", "departureAirportCode"=>"MRU", "arrivalDateTime"=>"2014-08-25T13:00:00", "arrivalAirportName"=>"München", "arrivalAirportCode"=>"MUC", "carrierName"=>"Emirates", "cabinClassName"=>"Economy Class", "passengers"=>[{"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Paul Pan"}, {"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Suse Pan"}], "sectors"=>[{"departureDateTime"=>"2014-08-24T22:15:00", "departureAirportName"=>"Mauritius", "departureAirportCode"=>"MRU", "arrivalDateTime"=>"2014-08-25T04:45:00", "arrivalAirportName"=>"Dubai", "arrivalAirportCode"=>"DXB", "carrierName"=>"Emirates", "carrierCode"=>"EK", "flightNumber"=>"EK3704", "cabinClassName"=>"Economy Class", "passengers"=>[{"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Paul Pan"}, {"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Suse Pan"}], "productType"=>nil, "serviceId"=>nil, "bookingCode"=>nil}, {"departureDateTime"=>"2014-08-25T08:25:00", "departureAirportName"=>"Dubai", "departureAirportCode"=>"DXB", "arrivalDateTime"=>"2014-08-25T13:00:00", "arrivalAirportName"=>"München", "arrivalAirportCode"=>"MUC", "carrierName"=>"Emirates", "carrierCode"=>"EK", "flightNumber"=>"EK49", "cabinClassName"=>"Economy Class", "passengers"=>[{"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>"1ST", "fullName"=>"Paul Pan"}, {"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>"1ST", "fullName"=>"Suse Pan"}], "productType"=>nil, "serviceId"=>nil, "bookingCode"=>nil}], "productType"=>"flight", "serviceId"=>"4241", "bookingCode"=>nil}], "name"=>"ItineraryView", "messages"=>nil, "ttl"=>nil}, "products"=>{"0"=>{"title"=>"Hereinspaziert!", "subTitle"=>"Atlantis, The Palm", "location"=>nil, "imageUrl"=>"https://mediacenter.tui-info.de/xmlprodpictures/tui/w0700_f04x03/i/il061419.jpg", "productType"=>"hotel", "serviceId"=>"3512", "reservationCode"=>"75511486"}, "1"=>{"title"=>"Hereinspaziert!", "subTitle"=>"Beachcomber Hotel Trou aux Biches Resort & Spa", "location"=>nil, "imageUrl"=>"https://mediacenter.tui-info.de/xmlprodpictures/tui/w0700_f04x03/d/de412472.jpg", "productType"=>"hotel", "serviceId"=>"3513", "reservationCode"=>"75511486"}, "2"=>{"title"=>"Versicherung", "subTitle"=>"(RRV) Reiserücktritt-Plus ohne SB - pro Person", "location"=>nil, "imageUrl"=>nil, "productType"=>"insurance", "serviceId"=>"1241", "reservationCode"=>"75511486"}, "3"=>{"title"=>"Dubai Hotels - Dubai Airport (4-8 Pers)", "subTitle"=>nil, "location"=>nil, "imageUrl"=>nil, "productType"=>"transfer", "serviceId"=>"272", "reservationCode"=>"75511486"}, "4"=>{"title"=>"Flughafen Mauritius - Hotels Mauritius (Minibus, 1-6 Pers.)", "subTitle"=>nil, "location"=>nil, "imageUrl"=>nil, "productType"=>"transfer", "serviceId"=>"273", "reservationCode"=>"75511486"}, "flight"=>[{"departureAirportCode"=>"MUC", "departureAirportName"=>"München", "arrivalAirportCode"=>"MRU", "arrivalAirportName"=>"Mauritius", "departureDateTime"=>"2014-08-12T22:35:00", "arrivalDateTime"=>"2014-08-14T09:35:00", "passengers"=>[{"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Paul Pan"}, {"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Suse Pan"}], "title"=>"Ihr Flug", "subTitle"=>"Abflug am Dienstag, 12. August 2014", "location"=>nil, "imageUrl"=>nil, "productType"=>"flight", "serviceId"=>"4240", "reservationCode"=>"75511486"}, {"departureAirportCode"=>"MRU", "departureAirportName"=>"Mauritius", "arrivalAirportCode"=>"MUC", "arrivalAirportName"=>"München", "departureDateTime"=>"2014-08-24T22:15:00", "arrivalDateTime"=>"2014-08-25T13:00:00", "passengers"=>[{"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Paul Pan"}, {"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Suse Pan"}], "title"=>"Ihr Flug", "subTitle"=>"Abflug am Sonntag, 24. August 2014", "location"=>nil, "imageUrl"=>nil, "productType"=>"flight", "serviceId"=>"4241", "reservationCode"=>"75511486"}]}, "destinationGuide"=>{"numberOfLocations"=>2, "data"=>{"ARE"=>{"country3LC"=>"ARE", "destinationName"=>"Vereinigte Arabische Emirate", "imageUrl"=>"http://www.tui-info.de/ICAT/mediadata/laenderbilder/ARE.jpg"}, "MUS"=>{"country3LC"=>"MUS", "destinationName"=>"Mauritius", "imageUrl"=>"http://www.tui-info.de/ICAT/mediadata/laenderbilder/MUS.jpg"}}}, "excursions"=>{"excursionCount"=>20, "imageUrl"=>"https://mediacenter.tui-info.de/meinetui/app/img/excursion.jpg", "numberOfLocations"=>2}, "meetYourRep"=>nil, "goodToKnow"=>{"numberOfLocations"=>2, "data"=>{"ARE"=>{"country3LC"=>"ARE", "destinationName"=>"Vereinigte Arabische Emirate"}, "MUS"=>{"country3LC"=>"MUS", "destinationName"=>"Mauritius"}}}, "currency"=>{"fromCurrency"=>"EUR", "MUR"=>"41.53830", "AED"=>"5.02050"}, "travelAgent"=>true, "tuiService"=>true, "contact"=>true, "ttl"=>21600}, "name"=>"HomeScreenView"}

  booking_id=75511407
  FLIGHT_BOOKING||= {"payload"=>{"destination"=>"Palma de Mallorca", "userName"=>"Peter Pan", "reservationCode"=>"75511407", "brand"=>"tui", "countdown"=>{"startDateTimeAsUnixTime"=>1409972400, "endDateTimeAsUnixTime"=>1409954400, "status"=>"countdown"}, "weather"=>{"numberOfLocations"=>1, "data"=>[{"name"=>"Palma de Mallorca", "type"=>0, "temperature"=>24, "temperatureFor"=>"air"}]}, "bookingSummary"=>{"brand"=>"tui", "overview"=>{"infoList"=>[{"key"=>"bookingCode", "value"=>"75511407", "title"=>"Vorgang/Buchungsnummer", "type"=>"string", "order"=>1}, {"key"=>"countdownStartDateAsUnixTime", "value"=>1409972400, "title"=>"Countdown", "type"=>"integer", "order"=>2}, {"key"=>"leadPassenger", "value"=>"Peter Pan", "title"=>"Gebucht für", "type"=>"string", "order"=>3}, {"key"=>"otherPassengers", "value"=>["Petra Pan"], "title"=>"Weitere Reisende", "type"=>"array", "order"=>4}]}, "productDetails"=>[{"flightTimesSubjectToChange"=>true, "departureDateTime"=>"2014-09-06T05:00:00", "departureAirportName"=>"Hannover", "departureAirportCode"=>"HAJ", "arrivalDateTime"=>"2014-09-06T07:30:00", "arrivalAirportName"=>"Palma de Mallorca", "arrivalAirportCode"=>"PMI", "carrierName"=>"Germanwings", "cabinClassName"=>"Economy Class", "passengers"=>[{"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Peter Pan"}, {"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Petra Pan"}], "sectors"=>[{"departureDateTime"=>"2014-09-06T05:00:00", "departureAirportName"=>"Hannover", "departureAirportCode"=>"HAJ", "arrivalDateTime"=>"2014-09-06T07:30:00", "arrivalAirportName"=>"Palma de Mallorca", "arrivalAirportCode"=>"PMI", "carrierName"=>"Germanwings", "carrierCode"=>"GWI", "flightNumber"=>"GWI5000", "cabinClassName"=>"Economy Class", "passengers"=>[{"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>"NONE", "arrivalAirportRailClass"=>"NONE", "fullName"=>"Peter Pan"}, {"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>"NONE", "arrivalAirportRailClass"=>"NONE", "fullName"=>"Petra Pan"}], "productType"=>nil, "serviceId"=>nil, "bookingCode"=>nil}], "productType"=>"flight", "serviceId"=>"4242", "bookingCode"=>nil}], "name"=>"ItineraryView", "messages"=>nil, "ttl"=>nil}, "products"=>{"flight"=>[{"departureAirportCode"=>"HAJ", "departureAirportName"=>"Hannover", "arrivalAirportCode"=>"PMI", "arrivalAirportName"=>"Palma de Mallorca", "departureDateTime"=>"2014-09-06T05:00:00", "arrivalDateTime"=>"2014-09-06T07:30:00", "passengers"=>[{"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Peter Pan"}, {"seatRow"=>nil, "seatColumn"=>nil, "departureAirportRailClass"=>nil, "arrivalAirportRailClass"=>nil, "fullName"=>"Petra Pan"}], "title"=>"Ihr Flug", "subTitle"=>"Abflug am Samstag, 06. September 2014", "location"=>nil, "imageUrl"=>nil, "productType"=>"flight", "serviceId"=>"4242", "reservationCode"=>"75511407"}]}, "destinationGuide"=>{"numberOfLocations"=>1, "data"=>{"ESP"=>{"country3LC"=>"ESP", "destinationName"=>"Spanien", "imageUrl"=>"http://www.tui-info.de/ICAT/mediadata/laenderbilder/ESP.jpg"}}}, "excursions"=>nil, "meetYourRep"=>nil, "goodToKnow"=>{"numberOfLocations"=>1, "data"=>{"ESP"=>{"country3LC"=>"ESP", "destinationName"=>"Spanien"}}}, "currency"=>nil, "travelAgent"=>true, "tuiService"=>nil, "contact"=>true, "ttl"=>21600}, "name"=>"HomeScreenView"}

  booking_id=80522737
  NON_EU_BOOKING||= {"payload"=>{"destination"=>"Thailand", "userName"=>"Peter Pan", "reservationCode"=>"80522737", "brand"=>"tui", "countdown"=>{"startDateTimeAsUnixTime"=>1410793200, "endDateTimeAsUnixTime"=>1410732000, "status"=>"countdown"}, "weather"=>nil, "bookingSummary"=>{"brand"=>"tui", "overview"=>{"infoList"=>[{"key"=>"bookingCode", "value"=>"80522737", "title"=>"Vorgang/Buchungsnummer", "type"=>"string", "order"=>1}, {"key"=>"countdownStartDateAsUnixTime", "value"=>1410793200, "title"=>"Countdown", "type"=>"integer", "order"=>2}, {"key"=>"leadPassenger", "value"=>"Peter Pan", "title"=>"Gebucht für", "type"=>"string", "order"=>3}, {"key"=>"otherPassengers", "value"=>[], "title"=>"Weitere Reisende", "type"=>"array", "order"=>4}]}, "productDetails"=>[{"name"=>"Flughafen Bangkok - Hotel Bangkok (Minibus 1-5 Pers.)", "startDateTime"=>"2014-09-15T17:00:00", "endDateTime"=>"2014-09-15T00:00:00", "numberOfAdults"=>1, "numberOfChildren"=>0, "numberOfInfants"=>0, "numberOfPax"=>1, "productType"=>"transfer", "serviceId"=>"287", "bookingCode"=>"BKKXMV01"}], "name"=>"ItineraryView", "messages"=>nil, "ttl"=>nil}, "products"=>[{"title"=>"Flughafen Bangkok - Hotel Bangkok (Minibus 1-5 Pers.)", "subTitle"=>nil, "location"=>nil, "imageUrl"=>nil, "productType"=>"transfer", "serviceId"=>"287", "reservationCode"=>"80522737"}], "destinationGuide"=>{"numberOfLocations"=>1, "data"=>{"THA"=>{"country3LC"=>"THA", "destinationName"=>"Thailand", "imageUrl"=>"http://www.tui-info.de/ICAT/mediadata/laenderbilder/THA.jpg"}}}, "excursions"=>nil, "meetYourRep"=>nil, "goodToKnow"=>{"numberOfLocations"=>1, "data"=>{"THA"=>{"country3LC"=>"THA", "destinationName"=>"Thailand"}}}, "currency"=>{"fromCurrency"=>"EUR", "THB"=>"44.33300"}, "travelAgent"=>true, "tuiService"=>nil, "contact"=>true, "ttl"=>21600}, "name"=>"HomeScreenView"}

elsif $g_current_app== "EN_TH"
  surname=$g_current_user_details[:valid][:surname]
  departureDate=$g_current_user_details[:valid][:departuredate]
  visionBookingRef=$g_current_user_details[:valid][:VisionBookingRef]
  visionShopNumber=$g_current_user_details[:valid][:VisionShopNumber]

  begin
    cmd=%Q(curl 'http://e03682051d4856bdd66e2bf5a183986a8898c3bd.dev.tui.appcelerator.com/login' -H 'tui-public-key: fbe37b64-9a09-4bbd-ae59-d3433ba74af0' -H 'Origin: http://37.46.24.155:8001' -H 'tui-brand: uk-thomson' -H 'Accept-Language: en-US,en;q=0.8' -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryBFMoUGekbBDoloDt' -H 'Accept: */*' -H 'Referer: http://37.46.24.155:8001/index.html' -H 'Accept-Encoding: gzip,deflate,sdch' -H 'Connection: keep-alive' -H 'tui-handshake: ffa667411e1e44908aa3b66e18b84a7ea3eec658' --data-binary $'------WebKitFormBoundaryBFMoUGekbBDoloDt\r\nContent-Disposition: form-data; name="surname"\r\n\r\n#{surname}\r\n------WebKitFormBoundaryBFMoUGekbBDoloDt\r\nContent-Disposition: form-data; name="departureDate"\r\n\r\n#{departureDate}\r\n------WebKitFormBoundaryBFMoUGekbBDoloDt\r\nContent-Disposition: form-data; name="visionShopNumber"\r\n\r\n#{visionShopNumber}\r\n------WebKitFormBoundaryBFMoUGekbBDoloDt\r\nContent-Disposition: form-data; name="visionBookingRef"\r\n\r\n#{visionBookingRef}\r\n------WebKitFormBoundaryBFMoUGekbBDoloDt\r\nContent-Disposition: form-data; name="devicetype"\r\n\r\niphone\r\n------WebKitFormBoundaryBFMoUGekbBDoloDt\r\nContent-Disposition: form-data; name="deviceid"\r\n\r\n12346374\r\n------WebKitFormBoundaryBFMoUGekbBDoloDt--\r\n' --compressed)
    res=JSON.parse(`#{cmd}`)
    if (res["payload"]["message"] == "Login Successful")
      puts "THOMSON CURL SUCCESSFUL: DETAILS FETCHED FROM SERVER"
    end
  rescue
    fail "Not Server not responding"
  end

  eng_user= {"payload"=>{"surname"=>"Martin", "username"=>"Miss Martin", "reservationCode"=>"9999/12347813", "bookingRef"=>"9999/12347813", "holidayExtraLength"=>12, "retail"=>true, "departureDate"=>"2015-04-22", "returnDate"=>"2015-04-29", "holidayStatus"=>"PreDeparture", "destinationName"=>"Egypt", "todayTemperature"=>"28", "airportName"=>"London Gatwick", "todayIcon"=>"hazy", "hotel"=>"Nile Legacy", "productName"=>"Couples", "resortName"=>"Luxor", "inBrief"=>[{"Text"=>"Holidays to Luxor pack in magnificent ancient temples and the last resting place of the pharaohs. But this Egyptian city bordering the Nile also offers up hidden souks and bustling city life."}], "flight"=>[{"ArrivalAirportCode"=>"LXR", "ArrivalAirportName"=>"Luxor", "ArrivalDate"=>"2015-04-22", "CheckInTime"=>nil, "CheckOutTime"=>nil, "DepartureAirportCode"=>"LGW", "DepartureAirportName"=>"London Gatwick", "DepartureDate"=>"2015-04-22", "Duration"=>"06:20:00", "FlightNumber"=>"tom", "LegNumber"=>1}, {"ArrivalAirportCode"=>"LGW", "ArrivalAirportName"=>"London Gatwick", "ArrivalDate"=>"2015-04-29", "CheckInTime"=>nil, "CheckOutTime"=>nil, "DepartureAirportCode"=>"LXR", "DepartureAirportName"=>"Luxor", "DepartureDate"=>"2015-04-29", "Duration"=>"04:55:00", "FlightNumber"=>"", "LegNumber"=>2}], "destination"=>"Egypt", "ttl"=>3600, "destinationImg"=>["http://media.thomson.co.uk/asset/lpp/v00/910/857.jpg", "http://media.thomson.co.uk/asset/lpp/v00/863/894.jpg", "http://media.thomson.co.uk/asset/lpp/v00/909/996.jpg"], "hotelImg"=>["http://media.thomson.co.uk/asset/lpp/v01/039/111.jpg", "http://media.thomson.co.uk/asset/lpp/v01/039/105.jpg", "http://media.thomson.co.uk/asset/lpp/v01/039/125.jpg"], "excursions"=>{"imageUrl"=>[], "numberOfExcursions"=>0}, "currency"=>{"fromCurrency"=>"GBP", "EGP"=>10.54}, "currencyRate"=>10.54, "currencyCode"=>"EGP", "currencySymbol"=>"ج.م", "countdown"=>{"startDateTimeAsUnixTime"=>1429694400, "endDateTimeAsUnixTime"=>1430343300, "status"=>"countdown"}, "weather"=>{"data"=>[{"name"=>"Egypt", "temperature"=>"28", "temperatureFor"=>"air", "type"=>2}], "numberOfLocations"=>1}, "destinationGuide"=>{"data"=>{"dest"=>{"destinationName"=>"Egypt", "imageUrl"=>["http://media.thomson.co.uk/asset/lpp/v00/910/857.jpg", "http://media.thomson.co.uk/asset/lpp/v00/863/894.jpg", "http://media.thomson.co.uk/asset/lpp/v00/909/996.jpg"]}}}, "products"=>{"extra"=>{"productType"=>"extra", "multiple"=>false}, "hotel"=>{"title"=>"", "subTitle"=>"Nile Legacy", "location"=>{"latitude"=>25.701897, "longitude"=>32.638424}, "productType"=>"hotel", "imageUrl"=>["http://media.thomson.co.uk/asset/lpp/v01/039/111.jpg", "http://media.thomson.co.uk/asset/lpp/v01/039/105.jpg", "http://media.thomson.co.uk/asset/lpp/v01/039/125.jpg"]}, "flight"=>[{"arrivalAirportCode"=>"LXR", "arrivalAirportName"=>"Luxor", "departureAirportCode"=>"LGW", "departureAirportName"=>"London Gatwick", "subTitle"=>"Departing on Wed 22 Apr 2015", "passengers"=>[{"fullName"=>"Mr N Martin"}]}, {"arrivalAirportCode"=>"LGW", "arrivalAirportName"=>"London Gatwick", "departureAirportCode"=>"LXR", "departureAirportName"=>"Luxor", "subTitle"=>"Departing on Wed 29 Apr 2015", "passengers"=>[{"fullName"=>"Mr N Martin"}]}]}, "ItineraryView"=>{"name"=>"ItineraryView"}}}
  $g_ENG_USER_DETAILS=eng_user
  checklist={"payload"=>{"itemList"=>[{"category"=>1, "id"=>"05368cd2-f528-49bb-9ba2-bf05fbddc3ec", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-23T11:12:23", "message"=>"Change my holiday money - The currency for Egypt is the Egyptian Pound. At the moment, the typical exchange rate is £1 = 10.54. Exchange your currency with Thomson today and you'll also get 0% commission on your travel money.", "link"=>"http://www.thomsonmoney.co.uk", "completed"=>false}, {"category"=>1, "id"=>"8bc81547-da93-4411-9de4-5b6808491b43", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-23T11:12:23", "message"=>"Plan my excursions - Browse our range of great excursions and book them before you go on the MyThomson app or website.", "link"=>nil, "completed"=>false}, {"category"=>1, "id"=>"42351ed7-33f8-4614-b8f4-760c91c2c6e3", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-23T11:12:23", "message"=>"Add Advanced Passenger Information - It's essential you tell us this information between 6 months and 24 hours before your departure.", "link"=>"https://eapi.thomson.co.uk/eborders/login.jsp", "completed"=>false}, {"category"=>1, "id"=>"17501d80-acbb-4898-9e9e-6d13124c6ef1", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-23T11:12:23", "message"=>"Check my tickets - Take a look over your final tickets to make sure all of your details are correct, like the spelling of your name and flight times.", "link"=>nil, "completed"=>false}, {"category"=>1, "id"=>"e5e10157-71e3-460f-922d-93667388dbde", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-23T11:12:23", "message"=>"Apply for visas - You can check if you need a visa for your trip by visiting The Travel Visa Company.", "link"=>"http://www.thetravelvisacompany.co.uk", "completed"=>false}, {"category"=>1, "id"=>"5e4f7ecc-e29d-463f-b0b5-0cd623d7a978", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-23T11:12:23", "message"=>"Get my vaccinations - We recommend you speak to your doctor about any injections you might need at least 2 months before your holiday.", "link"=>nil, "completed"=>false}, {"category"=>1, "id"=>"81eb9850-b26e-413b-b920-b956dfc8a5c6", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-23T11:12:23", "message"=>"Plan my route to the airport - Map your journey by car, train or coach on the MyThomson app or website.", "link"=>nil, "completed"=>false}, {"category"=>1, "id"=>"f3d94042-1dd2-4556-adb1-b17c21ad09a1", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-23T11:12:23", "message"=>"Check my passports are valid - When travelling to certain countries you need at least 6 months left on your passport. If you need to apply for a new passport, please do this at least 8 weeks before you travel.", "link"=>"https://www.gov.uk/browse/abroad/passports", "completed"=>false}, {"category"=>1, "id"=>"49d5c51e-637b-4706-b389-3e7122e23a71", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-23T11:12:23", "message"=>"Book an airport lounge - Relax before your flight with free snacks, drinks and entertainment.", "link"=>"http://www.holidayextras.co.uk/thomson/lounges.html?agent=WT560", "completed"=>false}, {"category"=>1, "id"=>"116999ea-2ba2-4fa8-be99-8e6c87396e0a", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-23T11:12:23", "message"=>"Get travel insurance - Avoid any holiday mishaps by choosing the right policy to suit you and your travel companions.", "link"=>"http://www.thomsonins.co.uk", "completed"=>false}, {"category"=>1, "id"=>"29224985-67f9-4629-8492-54ab2bea3e0a", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-23T11:12:23", "message"=>"Book an airport parking space - Get money off your space at the airport with Thomson.", "link"=>"http://www.holidayextras.co.uk/thomson/parking.html?agent=WT560", "completed"=>false}]}}
  $g_engChecklist=checklist["payload"]["itemList"]
  $g_current_booking=eng_user
  $eng_booking_summary={"payload"=>{"bookingRef"=>"9999/12347813", "displayFlightTimes"=>false, "holidayStatus"=>"PreDeparture", "destinationName"=>"Egypt", "hotelAndFlightsBookingRef"=>11111, "hotelName"=>"Nile Legacy", "flightCollection"=>[{"ArrivalAirportCode"=>"LXR", "ArrivalAirportName"=>"Luxor", "ArrivalDate"=>"2015-04-22", "CheckInTime"=>nil, "CheckOutTime"=>nil, "DepartureAirportCode"=>"LGW", "DepartureAirportName"=>"London Gatwick", "DepartureDate"=>"2015-04-22", "Duration"=>"06:20:00", "FlightNumber"=>"tom", "LegNumber"=>1, "ArrivalAirportNickName"=>"Luxor", "DepartureAirportNickName"=>"London Gatwick"}, {"ArrivalAirportCode"=>"LGW", "ArrivalAirportName"=>"London Gatwick", "ArrivalDate"=>"2015-04-29", "CheckInTime"=>nil, "CheckOutTime"=>nil, "DepartureAirportCode"=>"LXR", "DepartureAirportName"=>"Luxor", "DepartureDate"=>"2015-04-29", "Duration"=>"04:55:00", "FlightNumber"=>"", "LegNumber"=>2, "ArrivalAirportNickName"=>"London Gatwick", "DepartureAirportNickName"=>"Luxor"}], "passengerCollection"=>[{"Initial"=>"N", "LeadBookerIndicator"=>true, "Surname"=>"Martin", "Title"=>"Mr"}], "ttl"=>21600}}
elsif $g_nordics_app
  bookingnumber=$g_current_user_details[:valid][:bookingnumber]
  emailid=$g_current_user_details[:valid][:emailid]

  begin
    cmd=%Q(curl 'http://e03682051d4856bdd66e2bf5a183986a8898c3bd.dev.tui.appcelerator.com/login' -H 'Pragma: no-cache' -H 'tui-public-key: c324b71c-8c1b-49e2-8c5e-97f156d20141' -H 'Origin: http://37.46.24.155:8001' -H 'Cache-Control: no-cache' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36' -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryoHZeRePcVCpN8WMs' -H 'Referer: http://37.46.24.155:8001/index.html' -H 'tui-brand: nordics' -H 'tui-handshake: f77e4b14672e6fb9773902d266f32f848eb7cb78' --data-binary $'------WebKitFormBoundaryoHZeRePcVCpN8WMs\r\nContent-Disposition: form-data; name="reservationCode"\r\n\r\n#{bookingnumber}\r\n------WebKitFormBoundaryoHZeRePcVCpN8WMs\r\nContent-Disposition: form-data; name="email"\r\n\r\n#{emailid}\r\n------WebKitFormBoundaryoHZeRePcVCpN8WMs--\r\n' --compressed)
    res=JSON.parse(`#{cmd}`)
    if (res["status"] == 200)
      puts "NORDICS CURL SUCCESSFUL: DETAILS FETCHED FROM SERVER"
    end
  rescue
    fail "Not Server not responding"
  end

  nor_user={"payload"=>{"reservationCode"=>"AK56424", "brand"=>"tuinordic", "destination"=>"Gerani", "userName"=>"Westling", "countdown"=>{"startDateTimeAsUnixTime"=>1405861200, "endDateTimeAsUnixTime"=>1407708000, "status"=>"countdown", "share"=>{"text"=>"screen.common.share.facebook", "link"=>"http://www.fritidsresor.se.tuinordic.com/resa/grekland/kreta/gerani/?season=sommar-2014"}}, "weather"=>{"numberOfLocations"=>3, "data"=>[{"name"=>"Gerani", "type"=>0, "temperature"=>20, "temperatureFor"=>"air"}, {"name"=>"Agia Marina", "type"=>0, "temperature"=>21, "temperatureFor"=>"air"}, {"name"=>"Agii Apostoli", "type"=>0, "temperature"=>22, "temperatureFor"=>"air"}]}, "bookingSummary"=>{"brand"=>"tuinordic", "overview"=>{"infoList"=>[{"order"=>1, "key"=>"bookingCode", "type"=>"string", "title"=>"screen.common.reservationNumber", "value"=>["AK56424"]}, {"order"=>2, "key"=>"leadPassenger", "type"=>"string", "title"=>"Booked for", "value"=>["Westling Niclas"]}, {"order"=>3, "key"=>"otherPassengers", "type"=>"string", "title"=>"Other passengers", "value"=>["Westling Pelle", "Westling Kalle", "Westling Lelle"]}]}, "productDetails"=>[{"flight"=>{"productType"=>"flight", "serviceId"=>"flight-out", "departureDateTime"=>"2014-07-20T17:00:00", "departureAirportName"=>"Helsinki", "departureAirportCode"=>"HEL", "arrivalDateTime"=>"2014-07-20T21:00:00", "arrivalAirportName"=>"Chania", "arrivalAirportCode"=>"CHQ", "carrierName"=>"Jet Time", "carrierCode"=>"JTG", "flightNumber"=>"JTG987", "passengers"=>[{"fullName"=>"Westling Niclas"}, {"fullName"=>"Westling Pelle"}, {"fullName"=>"Westling Kalle"}, {"fullName"=>"Westling Lelle"}], "sectors"=>[{"departureDateTime"=>"2014-07-20T17:00:00", "departureAirportName"=>"Helsinki", "departureAirportCode"=>"HEL", "arrivalDateTime"=>"2014-07-20T21:00:00", "arrivalAirportName"=>"Chania", "arrivalAirportCode"=>"CHQ", "carrierName"=>"Jet Time", "carrierCode"=>"JTG", "flightNumber"=>"JTG987", "passengers"=>[{"fullName"=>"Westling Niclas"}, {"fullName"=>"Westling Pelle"}, {"fullName"=>"Westling Kalle"}, {"fullName"=>"Westling Lelle"}]}]}}, {"flight"=>{"productType"=>"flight", "serviceId"=>"flight-home", "departureDateTime"=>"2014-08-10T22:00:00", "departureAirportName"=>"Chania", "departureAirportCode"=>"CHQ", "arrivalDateTime"=>"2014-08-11T02:00:00", "arrivalAirportName"=>"Helsinki", "arrivalAirportCode"=>"HEL", "carrierName"=>"Jet Time", "carrierCode"=>"JTG", "flightNumber"=>"JTG988", "passengers"=>[{"fullName"=>"Westling Niclas"}, {"fullName"=>"Westling Pelle"}, {"fullName"=>"Westling Kalle"}, {"fullName"=>"Westling Lelle"}], "sectors"=>[{"departureDateTime"=>"2014-08-10T22:00:00", "departureAirportName"=>"Chania", "departureAirportCode"=>"CHQ", "arrivalDateTime"=>"2014-08-11T02:00:00", "arrivalAirportName"=>"Helsinki", "arrivalAirportCode"=>"HEL", "carrierName"=>"Jet Time", "carrierCode"=>"JTG", "flightNumber"=>"JTG988", "passengers"=>[{"fullName"=>"Westling Niclas"}, {"fullName"=>"Westling Pelle"}, {"fullName"=>"Westling Kalle"}, {"fullName"=>"Westling Lelle"}]}]}}, {"hotel"=>{"productType"=>"hotel", "serviceId"=>"hotel-1", "name"=>"Lägenheter Kostakis Beach FFF+", "destination"=>"Gerani", "countryName"=>"Grekland", "startDate"=>"2014-07-20", "endDate"=>"2014-07-27", "rooms"=>[{"name"=>"Parveke\nRajoitettu merinäköala\nPerushinta, ei aterioita", "passengers"=>[{"fullName"=>"Westling Niclas"}, {"fullName"=>"Westling Pelle"}, {"fullName"=>"Westling Kalle"}, {"fullName"=>"Westling Lelle"}]}], "geoCoords"=>{"latitude"=>35.521604, "longitude"=>23.872792}}}, {"hotel"=>{"productType"=>"hotel", "serviceId"=>"hotel-2", "name"=>"Blue Star – Isida Village FFFF", "destination"=>"Agia Marina", "countryName"=>"Grekland", "startDate"=>"2014-07-27", "endDate"=>"2014-08-03", "rooms"=>[{"name"=>"Parveke\nPerushinta, ei aterioita\nIsida Residence", "passengers"=>[{"fullName"=>"Westling Niclas"}, {"fullName"=>"Westling Pelle"}, {"fullName"=>"Westling Kalle"}, {"fullName"=>"Westling Lelle"}]}], "geoCoords"=>{"latitude"=>35.517941, "longitude"=>23.923513}}}, {"hotel"=>{"productType"=>"hotel", "serviceId"=>"hotel-3", "name"=>"Lägenheter Lotus FFF+", "destination"=>"Agii Apostoli", "countryName"=>"Grekland", "startDate"=>"2014-08-03", "endDate"=>"2014-08-03", "rooms"=>[{"name"=>"Parveke tai maaterassi\nPerushinta, ei aterioita", "passengers"=>[{"fullName"=>"Westling Niclas"}, {"fullName"=>"Westling Pelle"}, {"fullName"=>"Westling Kalle"}, {"fullName"=>"Westling Lelle"}]}], "geoCoords"=>{"latitude"=>35.508225, "longitude"=>23.980563}}}]}, "products"=>[{"hotels"=>[{"productType"=>"hotel", "serviceId"=>"hotel-1", "reservationCode"=>"AK56424", "title"=>"screen.home.product.hotel.title", "subTitle"=>"Lägenheter Kostakis Beach FFF+", "imageUrl"=>"http://images.tuinordic.com/travel/images/Blue/Gallery/800-533/hotel-5439-1-0131417-1303270151.jpg"}, {"productType"=>"hotel", "serviceId"=>"hotel-2", "reservationCode"=>"AK56424", "title"=>"screen.home.product.hotel.title", "subTitle"=>"Blue Star – Isida Village FFFF", "imageUrl"=>"http://images.tuinordic.com/travel/images/Blue/Gallery/800-533/hotel-5434-1-0230934-1307230150.jpg"}, {"productType"=>"hotel", "serviceId"=>"hotel-3", "reservationCode"=>"AK56424", "title"=>"screen.home.product.hotel.title", "subTitle"=>"Lägenheter Lotus FFF+", "imageUrl"=>"http://images.tuinordic.com/travel/images/Blue/Gallery/800-533/hotel-4400-1-0235090-1210050420.jpg"}], "flights"=>[{"productType"=>"flight", "serviceId"=>"flight-out", "reservationCode"=>"AK56424", "title"=>"screen.home.product.flight.title", "subTitle"=>"static.text.flight.dep.date", "departureDateTime"=>"2014-07-20T17:00:00", "departureAirportCode"=>"HEL", "departureAirportName"=>"Helsinki", "arrivalDateTime"=>"2014-07-20T21:00:00", "arrivalAirportCode"=>"CHQ", "arrivalAirportName"=>"Chania", "passengers"=>[{"fullName"=>"Westling Niclas"}, {"fullName"=>"Westling Pelle"}, {"fullName"=>"Westling Kalle"}, {"fullName"=>"Westling Lelle"}]}, {"productType"=>"flight", "serviceId"=>"flight-home", "reservationCode"=>"AK56424", "title"=>"screen.home.product.flight.title", "subTitle"=>"static.text.flight.arr.date", "departureDateTime"=>"2014-08-10T22:00:00", "departureAirportCode"=>"CHQ", "departureAirportName"=>"Chania", "arrivalDateTime"=>"2014-08-11T02:00:00", "arrivalAirportCode"=>"HEL", "arrivalAirportName"=>"Helsinki", "passengers"=>[{"fullName"=>"Westling Niclas"}, {"fullName"=>"Westling Pelle"}, {"fullName"=>"Westling Kalle"}, {"fullName"=>"Westling Lelle"}]}]}], "destinationGuide"=>{"numberOfLocations"=>3, "data"=>[{"destinationName"=>"Gerani", "imageUrl"=>"http://images.tuinordic.com/travel/images/Blue/Gallery/800-533/city-1047-1-0231968-1308290152.jpg"}, {"destinationName"=>"Agia Marina", "imageUrl"=>"http://images.tuinordic.com/travel/images/Blue/Gallery/800-533/city-319-1-0231963-1210030200.jpg"}, {"destinationName"=>"Agii Apostoli", "imageUrl"=>"http://images.tuinordic.com/travel/images/Blue/Gallery/800-533/city-320-1-0250216-1308290201.jpg"}]}, "excursions"=>{"numberOfLocations"=>1, "excursionCount"=>1, "imageUrl"=>"screen.excursions.imageUrl", "numberOfExcursions"=>1}, "guideOnline"=>{"messageCount"=>0, "message"=>""}}}
  $g_NOR_user=nor_user
  $g_current_booking=nor_user
elsif $g_current_app== "EN_FC"
  surname=$g_current_user_details[:valid][:surname]
  departureDate=$g_current_user_details[:valid][:departuredate]
  visionBookingRef=$g_current_user_details[:valid][:VisionBookingRef]
  visionShopNumber=$g_current_user_details[:valid][:VisionShopNumber]

  begin
    cmd=%Q(curl 'https://e03682051d4856bdd66e2bf5a183986a8898c3bd.dev.tui.appcelerator.com/login' -H 'tui-public-key: 913840aa-9455-42a6-a4aa-8c8c4ccf7255' -H 'Origin: http://37.46.24.155:8001' -H 'tui-brand: uk-first-choice' -H 'Accept-Language: en-US,en;q=0.8' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36' -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryNDWgNkMgQSeSvoqm' -H 'Accept: */*' -H 'Referer: http://37.46.24.155:8001/index.html' -H 'Accept-Encoding: gzip,deflate,sdch' -H 'Connection: keep-alive' -H 'tui-handshake: 4ff213e9f194922fbb74d8e299f66f7daf7c286e' --data-binary $'------WebKitFormBoundaryNDWgNkMgQSeSvoqm\r\nContent-Disposition: form-data; name="surname"\r\n\r\nMartin\r\n------WebKitFormBoundaryNDWgNkMgQSeSvoqm\r\nContent-Disposition: form-data; name="departureDate"\r\n\r\n2015-04-20\r\n------WebKitFormBoundaryNDWgNkMgQSeSvoqm\r\nContent-Disposition: form-data; name="visionShopNumber"\r\n\r\n9999\r\n------WebKitFormBoundaryNDWgNkMgQSeSvoqm\r\nContent-Disposition: form-data; name="visionBookingRef"\r\n\r\n12346474\r\n------WebKitFormBoundaryNDWgNkMgQSeSvoqm\r\nContent-Disposition: form-data; name="devicetype"\r\n\r\niphone\r\n------WebKitFormBoundaryNDWgNkMgQSeSvoqm\r\nContent-Disposition: form-data; name="deviceid"\r\n\r\n12346374\r\n------WebKitFormBoundaryNDWgNkMgQSeSvoqm--\r\n' --compressed)
    res=JSON.parse(`#{cmd}`)
    if (res["payload"]["message"] == "Login Successful")
      puts "First choice CURL SUCCESSFUL: DETAILS FETCHED FROM SERVER"
    end
  rescue
    fail "Not Server not responding"
  end

  eng_user= {"payload"=>{"surname"=>"Martin", "username"=>"Mrs Martin", "reservationCode"=>"9999/12346474", "bookingRef"=>"9999/12346474", "holidayExtraLength"=>9, "retail"=>true, "departureDate"=>"2015-04-20", "returnDate"=>"2015-04-27", "holidayStatus"=>"PreDeparture", "destinationName"=>"Madeira", "todayTemperature"=>"21", "airportName"=>"London Gatwick", "todayIcon"=>"partly-cloudy", "hotel"=>"Pestana Bay", "productName"=>"Hotels", "resortName"=>"Funchal", "inBrief"=>[{"Text"=>"Holidays to Funchal are a real pick ’n’ mix job. You can laze round the lidos, spend in the shopping malls, or stroll in the gardens. All this and year-round sunshine, too."}], "flight"=>[{"ArrivalAirportCode"=>"FNC", "ArrivalAirportName"=>"Funchal", "ArrivalDate"=>"2015-04-20", "CheckInTime"=>nil, "CheckOutTime"=>nil, "DepartureAirportCode"=>"LGW", "DepartureAirportName"=>"London Gatwick", "DepartureDate"=>"2015-04-20", "Duration"=>"03:45:00", "FlightNumber"=>"TOM4134", "LegNumber"=>1}, {"ArrivalAirportCode"=>"LGW", "ArrivalAirportName"=>"London Gatwick", "ArrivalDate"=>"2015-04-27", "CheckInTime"=>nil, "CheckOutTime"=>nil, "DepartureAirportCode"=>"FNC", "DepartureAirportName"=>"Funchal", "DepartureDate"=>"2015-04-27", "Duration"=>"03:40:00", "FlightNumber"=>"TOM4135", "LegNumber"=>2}], "destination"=>"Madeira", "ttl"=>3600, "destinationImg"=>["http://media.thomson.co.uk/asset/lpp/v00/953/128.jpg", "http://media.thomson.co.uk/asset/lpp/v00/953/136.jpg", "http://media.thomson.co.uk/asset/lpp/v01/017/571.jpg"], "hotelImg"=>["http://media.thomson.co.uk/asset/lpp/v01/091/949.jpg", "http://media.thomson.co.uk/asset/lpp/v01/091/923.jpg", "http://media.thomson.co.uk/asset/lpp/v01/091/945.jpg"], "excursions"=>{"imageUrl"=>[], "numberOfExcursions"=>0}, "currency"=>{"fromCurrency"=>"GBP", "EUR"=>1.17}, "currencyRate"=>1.17, "currencyCode"=>"EUR", "currencySymbol"=>"€", "countdown"=>{"startDateTimeAsUnixTime"=>1429516800, "endDateTimeAsUnixTime"=>1430152800, "status"=>"countdown"}, "weather"=>{"data"=>[{"name"=>"Madeira", "temperature"=>"21", "temperatureFor"=>"air", "type"=>1}], "numberOfLocations"=>1}, "destinationGuide"=>{"data"=>{"dest"=>{"destinationName"=>"Madeira", "imageUrl"=>["http://media.thomson.co.uk/asset/lpp/v00/953/128.jpg", "http://media.thomson.co.uk/asset/lpp/v00/953/136.jpg", "http://media.thomson.co.uk/asset/lpp/v01/017/571.jpg"]}}}, "products"=>{"extra"=>{"productType"=>"extra", "multiple"=>false}, "hotel"=>{"title"=>"", "subTitle"=>"Pestana Bay", "location"=>{"latitude"=>32.63805, "longitude"=>-16.948883}, "productType"=>"hotel", "imageUrl"=>["http://media.thomson.co.uk/asset/lpp/v01/091/949.jpg", "http://media.thomson.co.uk/asset/lpp/v01/091/923.jpg", "http://media.thomson.co.uk/asset/lpp/v01/091/945.jpg"]}, "flight"=>[{"arrivalAirportCode"=>"FNC", "arrivalAirportName"=>"Funchal", "departureAirportCode"=>"LGW", "departureAirportName"=>"London Gatwick", "subTitle"=>"Departing on Mon 20 Apr 2015", "passengers"=>[{"fullName"=>"Mrs L Martin"}, {"fullName"=>"Mr E Martin"}]}, {"arrivalAirportCode"=>"LGW", "arrivalAirportName"=>"London Gatwick", "departureAirportCode"=>"FNC", "departureAirportName"=>"Funchal", "subTitle"=>"Departing on Mon 27 Apr 2015", "passengers"=>[{"fullName"=>"Mrs L Martin"}, {"fullName"=>"Mr E Martin"}]}]}, "ItineraryView"=>{"name"=>"ItineraryView"}}}
  $g_ENG_USER_DETAILS=eng_user
  $g_current_booking=eng_user
  checklist={"payload"=>{"itemList"=>[{"category"=>1, "id"=>"0b3804db-7edd-4494-827f-97e3f6a0db45", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-28T12:58:24", "message"=>"Get covered for emergency care – On top of your existing insurance, the European Health Insurance Card gives you free or reduced emergency care.", "link"=>"http://www.nhs.uk/NHSEngland/Healthcareabroad/EHIC/Pages/about-the-ehic.aspx", "completed"=>false}, {"category"=>1, "id"=>"946f524c-4570-4e71-a4bf-4337c7b516c1", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-28T12:58:24", "message"=>"Add Advanced Passenger Information – We need this information 24 hours before you depart. You can tick it off your list earlier by filling in this information up to 6 months before you fly.", "link"=>"http://www.firstchoice.co.uk/help/before-you-go/api", "completed"=>false}, {"category"=>1, "id"=>"e5d0c397-c0ff-429f-a059-47cb19aa3074", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-28T12:58:24", "message"=>"Check my tickets – Nothing worse than misreading a flight time.", "link"=>nil, "completed"=>false}, {"category"=>1, "id"=>"ccd827d3-ce3c-4a64-a393-6f3a3e5f0c5f", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-28T12:58:24", "message"=>"Apply for visas – Don’t wait until the last minute. Check if you need a visa for your trip by visiting The Travel Visa Company.", "link"=>"http://www.thetravelvisacompany.co.uk", "completed"=>false}, {"category"=>1, "id"=>"2e94925a-71d1-4309-b7f4-4a0f24bf3f66", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-28T12:58:24", "message"=>"Get my vaccinations – We recommend you speak to your doctor about any injections you might need at least 2 months before your holiday.", "link"=>nil, "completed"=>false}, {"category"=>1, "id"=>"31b85c01-0fa5-4ef4-b36c-de60c8fd70ee", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-28T12:58:24", "message"=>"Plan my route to the airport – Car, train or coach? Plan how you get to the airport with the My First Choice app or website.", "link"=>nil, "completed"=>false}, {"category"=>1, "id"=>"134ac523-1ca6-4862-bce1-8f60d9ef7156", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-28T12:58:24", "message"=>"Check to see if my passports are valid – Certain countries need at least 6 months left on your passport. Need a new passport? Apply at least 8 weeks before you travel.", "link"=>"https://www.gov.uk/browse/abroad/passports", "completed"=>false}, {"category"=>1, "id"=>"e825778f-bb36-43aa-bda3-c9212a8f4b08", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-28T12:58:24", "message"=>"Get travel insurance – Travelling can be tough. We have insurance policies with a wide range of coverages to fit your needs.", "link"=>"http://www.firstchoiceins.co.uk/travel/default.aspx", "completed"=>false}, {"category"=>1, "id"=>"ab65a83c-9472-42f2-b8c5-a485182852a2", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-28T12:58:24", "message"=>"Plan my excursions – Sightseeing. Adventuring. Plan your days early and we can offer you early bird savings. Book your excursions in the My First Choice app or on the website.", "link"=>nil, "completed"=>false}, {"category"=>1, "id"=>"f4f10f44-72c3-493b-99d6-d0b59bce5439", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-28T12:58:24", "message"=>"Book car hire – Get out and explore for as little as £9 a day.", "link"=>"http://www.carhiremarket.com/firstchoice", "completed"=>false}, {"category"=>1, "id"=>"24713bcf-585d-40b5-85cf-d9240987f891", "readOnly"=>true, "status"=>1, "touched"=>"2014-04-28T12:58:24", "message"=>"Change my holiday money – The currency for Madeira is the Euro.. At the moment, the typical exchange rate is £1 = 1.17. Order online or in your local Thomson shop commission-free.", "link"=>"https://www.firstchoice.co.uk/information/holiday-extras/before-you-go/foreign-exchange", "completed"=>false}]}}
  $g_engChecklist=checklist["payload"]["itemList"]
end
